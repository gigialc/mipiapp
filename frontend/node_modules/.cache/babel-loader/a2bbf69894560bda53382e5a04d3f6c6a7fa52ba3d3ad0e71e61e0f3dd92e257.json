{"ast":null,"code":"import _regeneratorRuntime from\"/Users/georgina/DestigFemmeDemoPi/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/georgina/DestigFemmeDemoPi/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/georgina/DestigFemmeDemoPi/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/georgina/DestigFemmeDemoPi/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";//Created by Georgina Alacaraz\nimport React from\"react\";import axios from\"axios\";import{onIncompletePaymentFound}from\"./Payments\";import{jsx as _jsx}from\"react/jsx-runtime\";export var UserContext=/*#__PURE__*/React.createContext(null);var _window=window;var backendURL=_window.__ENV&&_window.__ENV.backendURL;var axiosClient=axios.create({baseURL:\"\".concat(backendURL),timeout:20000,withCredentials:true});var AuthProvider=function AuthProvider(_ref){var children=_ref.children;var _React$useState=React.useState({uid:'',bio:\"\",username:'',coinbalance:0,community:[]}),_React$useState2=_slicedToArray(_React$useState,2),user=_React$useState2[0],setUser=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),showModal=_React$useState4[0],setShowModal=_React$useState4[1];var _React$useState5=React.useState([]),_React$useState6=_slicedToArray(_React$useState5,2),community=_React$useState6[0],setCommunity=_React$useState6[1];var _React$useState7=React.useState([]),_React$useState8=_slicedToArray(_React$useState7,2),post=_React$useState8[0],setPost=_React$useState8[1];var _React$useState9=React.useState([]),_React$useState10=_slicedToArray(_React$useState9,2),comment=_React$useState10[0],setComment=_React$useState10[1];var addCommunityToUser=function addCommunityToUser(newCommunity){setCommunity(function(prevCommunities){return[].concat(_toConsumableArray(prevCommunities),[newCommunity]);});};var addCommentToPost=function addCommentToPost(newComment){setPost(function(prevComments){return[].concat(_toConsumableArray(prevComments),[newComment]);});};var addPostToCommunity=function addPostToCommunity(newPost){setPost(function(prevPosts){return[].concat(_toConsumableArray(prevPosts),[newPost]);});};var addlikeToComment=function addlikeToComment(newLike){setComment(function(prevLikes){return[].concat(_toConsumableArray(prevLikes),[newLike]);});};var addlikeToPost=function addlikeToPost(newLike){setPost(function(prevLikes){return[].concat(_toConsumableArray(prevLikes),[newLike]);});};var signIn=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var scopes,authResult;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:scopes=['username','payments','wallet_address'];_context.next=3;return window.Pi.authenticate(scopes,onIncompletePaymentFound);case 3:authResult=_context.sent;_context.next=6;return signInUser(authResult);case 6:setUser(authResult.user);setShowModal(false);// getCommunity();\ncase 8:case\"end\":return _context.stop();}}},_callee);}));return function signIn(){return _ref2.apply(this,arguments);};}();var signInUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(authResult){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axiosClient.post('/user/signin',{authResult:authResult});case 2:return _context2.abrupt(\"return\",setShowModal(false));case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function signInUser(_x){return _ref3.apply(this,arguments);};}();var signOutUser=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var nullUser;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:nullUser={uid:'',bio:\"\",username:'',coinbalance:0,community:[],posts:[],comments:[],likes:[]};setUser(nullUser);case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function signOutUser(){return _ref4.apply(this,arguments);};}();var saveUser=function saveUser(){user.uid===''?signIn():signOutUser();};var saveShowModal=function saveShowModal(value){setShowModal(value);};var onModalClose=function onModalClose(){saveShowModal(false);};var userContext={user:user,community:community,// Add the community property to the userContext\nsaveUser:saveUser,showModal:showModal,saveShowModal:saveShowModal,onModalClose:onModalClose,addCommunityToUser:addCommunityToUser,addPostToCommunity:addPostToCommunity,addCommentToPost:addCommentToPost};return/*#__PURE__*/_jsx(UserContext.Provider,{value:userContext,children:children});};export default AuthProvider;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}