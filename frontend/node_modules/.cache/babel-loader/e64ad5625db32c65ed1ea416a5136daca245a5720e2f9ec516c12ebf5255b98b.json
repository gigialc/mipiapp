{"ast":null,"code":"import _regeneratorRuntime from\"/Users/georgina/DestigFemmeDemoPi/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/georgina/DestigFemmeDemoPi/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/georgina/DestigFemmeDemoPi/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState}from'react';import axios from'axios';import{TextField,Button,Stack}from'@mui/material';import{UserContext}from\"../components/Auth\";import{useLocation}from'react-router-dom';import{onReadyForServerApproval,onReadyForServerCompletion}from'./Payments';import CommentContent from'./CommentContent';// Make TS accept the existence of our window.__ENV object - defined in index.html:\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var _window=window;var backendURL=_window.__ENV&&_window.__ENV.backendURL;var axiosClient=axios.create({baseURL:\"\".concat(backendURL),timeout:20000,withCredentials:true});var config={headers:{'Content-Type':'application/json','Access-Control-Allow-Origin':'*'}};// Add null check\nexport default function Comments(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showForm=_useState2[0],setShowForm=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),description=_useState4[0],setDescription=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),descriptionError=_useState6[0],setDescriptionError=_useState6[1];var _ref=useContext(UserContext),user=_ref.user,showModal=_ref.showModal,saveShowModal=_ref.saveShowModal,onModalClose=_ref.onModalClose,addCommentToPost=_ref.addCommentToPost,addPostToCommunity=_ref.addPostToCommunity;//get the post id from the button\nvar location=useLocation();var postId=location.state.postId;console.log(postId);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();if(description.trim()){_context.next=4;break;}setDescriptionError('Description is required');return _context.abrupt(\"return\");case 4:if(!(user.uid===\"\")){_context.next=7;break;}saveShowModal(true);return _context.abrupt(\"return\");case 7:orderProduct('Comment',1,{postId:postId});// Call orderProduct with postId\ncase 8:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();var orderProduct=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(memo,amount,paymentMetadata){var paymentData,callbacks,payment,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(user.uid===\"\")){_context2.next=2;break;}return _context2.abrupt(\"return\",saveShowModal(true));case 2:paymentData={amount:amount,memo:memo,metadata:paymentMetadata};callbacks={onReadyForServerApproval:onReadyForServerApproval,onReadyForServerCompletion:onReadyForServerCompletion//onCancel,\n//onError\n};//make a payment\n_context2.next=6;return window.Pi.createPayment(paymentData,callbacks);case 6:payment=_context2.sent;console.log(payment);// Make an API call to add person to the community if the payment was successful\nif(description!==''){data={description:description,user_id:user===null||user===void 0?void 0:user.uid,post_id:postId,likes:[]};//check if payment was successful\n// if (payment.paymentCompleted === true){\naxiosClient.post(\"/comments/comments\",data,config).then(function(response){console.log(response.data);addCommentToPost(response.data);setDescription('');setShowForm(false);}).catch(function(error){console.log(error);});}case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function orderProduct(_x2,_x3,_x4){return _ref3.apply(this,arguments);};}();var onDescriptionChange=function onDescriptionChange(event){setDescription(event.target.value);if(descriptionError)setDescriptionError(null);// Reset error when user starts typing\n};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'32px',textAlign:'center'},children:[/*#__PURE__*/_jsx(CommentContent,{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(Stack,{spacing:1,direction:\"row\",alignItems:\"center\",justifyContent:\"center\",children:[/*#__PURE__*/_jsx(TextField,{id:\"description\",label:\"Comment\",value:description,onChange:onDescriptionChange,error:!!descriptionError,helperText:descriptionError||'',fullWidth:true,InputProps:{style:{borderRadius:'30px',height:\"35px\",// Adjust this value to control the roundness of the input field\ntextAlign:'center'// Center the text in the input field\n},inputProps:{style:{textAlign:'center'// Center the text in the input field\n}}},InputLabelProps:{// Move the label to the center\nstyle:{textAlign:'center'}}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",sx:{backgroundColor:'#ffe6ff',borderRadius:'20px',color:'black',height:'30px',textTransform:'none'}// Adjust height here\n,children:\"Submit\"})]})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{})]});};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}