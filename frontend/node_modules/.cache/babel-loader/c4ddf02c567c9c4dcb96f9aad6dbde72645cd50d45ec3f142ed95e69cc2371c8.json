{"ast":null,"code":"var _jsxFileName = \"/Users/georgina/DestigFemmeDemoPi/frontend/src/Shop/pages/newsletter.tsx\",\n  _s = $RefreshSig$();\nimport SignIn from \"../components/SignIn\";\nimport Header from \"../components/Header\";\nimport { Typography } from \"@mui/material\";\nimport { UserContext } from \"../components/Auth\";\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport MuiBottomNavigation from \"../../MuiBottomNavigation\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst _window = window;\nconst backendURL = _window.__ENV && _window.__ENV.backendURL;\nconst axiosClient = axios.create({\n  baseURL: `${backendURL}`,\n  timeout: 35000,\n  withCredentials: true\n});\n\n/* DEVELOPER NOTE:\n* this page retrieves and displays all the eligible refunds a user has. \n* it will execute the refund when signaled by the user and return an alert when done.\n*/\n\nexport default function AppToUserPayments() {\n  _s();\n  const {\n    user,\n    saveUser,\n    saveShowModal,\n    showModal,\n    refunds,\n    saveRefunds,\n    onModalClose\n  } = React.useContext(UserContext);\n  const [showRefundAlert, setShowRefundAlert] = useState(false);\n  const [refundInfoState, setRefundInformation] = useState({\n    message: \"\",\n    block_explorer_link: \"\"\n  });\n  const [refundProcessing, setRefundProcessing] = useState(false);\n  const orderRefund = async (memo, originalPayment) => {\n    if (refundProcessing) {\n      return console.log(\"refund already in progress\");\n    }\n    setRefundProcessing(true);\n    if (user.uid === \"\") {\n      setRefundProcessing(false);\n      return saveShowModal(true);\n    }\n    const refundPaymentID = originalPayment.pi_payment_id;\n    const refundPaymentAmount = originalPayment.amount;\n    const paymentData = {\n      memo,\n      refundPaymentID,\n      refundPaymentAmount\n    };\n    const returnInfo = await axiosClient.post('/payments/refundable_payment/refund_payment', paymentData);\n    const refundInformation = returnInfo.data;\n    console.log('refund information: ', refundInformation);\n    setRefundInformation(refundInformation);\n    saveRefunds();\n    setShowRefundAlert(true);\n    setRefundProcessing(false);\n  };\n  useEffect(() => {\n    saveRefunds();\n    // eslint-disable-next-line\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h4\",\n      margin: 3,\n      children: \"App to User Payments\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }, this), user.uid === '' || refunds[0] === undefined ? /*#__PURE__*/_jsxDEV(RefundCard, {\n      name: \"none\",\n      description: \"Did the delivery person eat your pie and now you need a refund?\",\n      pictureCaption: \"Picture by David McLeish - https://www.flickr.com/photos/shishberg/2310078068/, CC BY-SA 2.0\",\n      pictureURL: \"https://live.staticflickr.com/2143/2310078068_627e69cea2_k.jpg\",\n      amount: 1,\n      onClickRefund: () => saveRefunds(),\n      variant: refundProcessing\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }, this) : refunds.map(order => {\n      return /*#__PURE__*/_jsxDEV(RefundCard, {\n        name: order.product_id,\n        description: \"Did the delivery person eat your pie and now you need a refund?\",\n        pictureCaption: \"Picture by David McLeish - https://www.flickr.com/photos/shishberg/2310078068/, CC BY-SA 2.0\",\n        pictureURL: \"https://live.staticflickr.com/2143/2310078068_627e69cea2_k.jpg\",\n        amount: order.amount,\n        onClickRefund: () => orderRefund(\"User Requested Refund\", order),\n        variant: refundProcessing\n      }, order.product_id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 24\n      }, this);\n    }), showModal && /*#__PURE__*/_jsxDEV(SignIn, {\n      onSignIn: saveUser,\n      onModalClose: onModalClose,\n      showModal: showModal\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 28\n    }, this), showRefundAlert && /*#__PURE__*/_jsxDEV(Refund, {\n      refundedTransaction: refundInfoState,\n      onRefundClose: () => setShowRefundAlert(false),\n      showRefundAlert: showRefundAlert\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 34\n    }, this), /*#__PURE__*/_jsxDEV(MuiBottomNavigation, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n_s(AppToUserPayments, \"UFx0bf7aRsVYMkmx/+gDbAao3fw=\");\n_c = AppToUserPayments;\nvar _c;\n$RefreshReg$(_c, \"AppToUserPayments\");","map":{"version":3,"names":["SignIn","Header","Typography","UserContext","React","useEffect","useState","axios","MuiBottomNavigation","jsxDEV","_jsxDEV","Fragment","_Fragment","_window","window","backendURL","__ENV","axiosClient","create","baseURL","timeout","withCredentials","AppToUserPayments","_s","user","saveUser","saveShowModal","showModal","refunds","saveRefunds","onModalClose","useContext","showRefundAlert","setShowRefundAlert","refundInfoState","setRefundInformation","message","block_explorer_link","refundProcessing","setRefundProcessing","orderRefund","memo","originalPayment","console","log","uid","refundPaymentID","pi_payment_id","refundPaymentAmount","amount","paymentData","returnInfo","post","refundInformation","data","children","fileName","_jsxFileName","lineNumber","columnNumber","variant","margin","undefined","RefundCard","name","description","pictureCaption","pictureURL","onClickRefund","map","order","product_id","onSignIn","Refund","refundedTransaction","onRefundClose","_c","$RefreshReg$"],"sources":["/Users/georgina/DestigFemmeDemoPi/frontend/src/Shop/pages/newsletter.tsx"],"sourcesContent":["\nimport SignIn from \"../components/SignIn\";\nimport Header from \"../components/Header\";\nimport { RefundType, UserContextType, WindowWithEnv } from \"../components/Types\";\nimport { Typography } from \"@mui/material\";\nimport { UserContext } from \"../components/Auth\";\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport MuiBottomNavigation from \"../../MuiBottomNavigation\";\n\nconst _window: WindowWithEnv = window;\nconst backendURL = _window.__ENV && _window.__ENV.backendURL;\nconst axiosClient = axios.create({ baseURL: `${backendURL}`, timeout: 35000, withCredentials: true});\n\n/* DEVELOPER NOTE:\n* this page retrieves and displays all the eligible refunds a user has. \n* it will execute the refund when signaled by the user and return an alert when done.\n*/\n\nexport default function AppToUserPayments() {\n  const { user, saveUser, saveShowModal, showModal, refunds, saveRefunds, onModalClose } = React.useContext(UserContext) as UserContextType;\n  const [showRefundAlert, setShowRefundAlert] = useState(false);\n  const [refundInfoState, setRefundInformation] = useState<{message: string, block_explorer_link: string}>({message: \"\", block_explorer_link: \"\"});\n  const [refundProcessing, setRefundProcessing] = useState(false);\n\n  const orderRefund = async (memo: string, originalPayment: RefundType) => {\n    if(refundProcessing){\n      return console.log(\"refund already in progress\");\n    }\n\n    setRefundProcessing(true);\n    if(user.uid === \"\") {\n      setRefundProcessing(false);\n      return saveShowModal(true);\n    }\n\n    const refundPaymentID = originalPayment.pi_payment_id;\n    const refundPaymentAmount = originalPayment.amount;\n    const paymentData = { memo, refundPaymentID, refundPaymentAmount};\n    const returnInfo  = await axiosClient.post('/payments/refundable_payment/refund_payment', paymentData);\n    const refundInformation = returnInfo.data\n    console.log('refund information: ', refundInformation)\n    setRefundInformation(refundInformation);\n\n    saveRefunds();\n    setShowRefundAlert(true);\n    setRefundProcessing(false);\n  }\n\n  useEffect(() => {\n    saveRefunds();\n    // eslint-disable-next-line\n  },[]);\n\nreturn (    \n        <>\n            <Header/>\n            <Typography variant=\"h4\" margin={3}>\n              App to User Payments\n            </Typography>\n                        \n            {(user.uid === '' || refunds[0] === undefined) ? \n            <RefundCard \n            name= 'none'\n            description= \"Did the delivery person eat your pie and now you need a refund?\"\n            pictureCaption=\"Picture by David McLeish - https://www.flickr.com/photos/shishberg/2310078068/, CC BY-SA 2.0\"\n            pictureURL=\"https://live.staticflickr.com/2143/2310078068_627e69cea2_k.jpg\"\n            amount={1}\n            onClickRefund={()=> saveRefunds()}\n            variant={refundProcessing}\n            />\n            :\n            refunds.map((order: RefundType) =>{\n                return <RefundCard\n                  key={order.product_id}\n                  name={order.product_id}\n                  description= \"Did the delivery person eat your pie and now you need a refund?\"\n                  pictureCaption=\"Picture by David McLeish - https://www.flickr.com/photos/shishberg/2310078068/, CC BY-SA 2.0\"\n                  pictureURL=\"https://live.staticflickr.com/2143/2310078068_627e69cea2_k.jpg\"\n                  amount={order.amount}\n                  onClickRefund={()=> orderRefund(\"User Requested Refund\", order)}\n                  variant={refundProcessing}\n                />\n              })\n            }\n            \n            { showModal && <SignIn onSignIn={saveUser} onModalClose={onModalClose} showModal={showModal}/> }\n            { showRefundAlert && <Refund refundedTransaction={refundInfoState} onRefundClose={() => setShowRefundAlert(false)} showRefundAlert={showRefundAlert} /> }\n\n            <MuiBottomNavigation />\n        </>\n    )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}