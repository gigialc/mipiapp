{"ast":null,"code":"import _regeneratorRuntime from\"/Users/georgina/DestigFemmeDemoPi/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/georgina/DestigFemmeDemoPi/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/georgina/DestigFemmeDemoPi/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import axios from'axios';import ProductCard from'./components/ProductCard';import SignIn from'./components/SignIn';import Header from'./components/Header';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";;// Make TS accept the existence of our window.__ENV object - defined in index.html:\nvar _window=window;var backendURL=_window.__ENV&&_window.__ENV.backendURL;var axiosClient=axios.create({baseURL:\"\".concat(backendURL),timeout:20000,withCredentials:true});var config={headers:{'Content-Type':'application/json','Access-Control-Allow-Origin':'*'}};export default function Shop(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showModal=_useState4[0],setShowModal=_useState4[1];var signIn=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var scopes,authResult;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:scopes=['username','payments'];_context.next=3;return window.Pi.authenticate(scopes,onIncompletePaymentFound);case 3:authResult=_context.sent;signInUser(authResult);setUser(authResult.user);case 6:case\"end\":return _context.stop();}}},_callee);}));return function signIn(){return _ref.apply(this,arguments);};}();var signOut=function signOut(){setUser(null);signOutUser();};var signInUser=function signInUser(authResult){axiosClient.post('/user/signin',{authResult:authResult});return setShowModal(false);};var signOutUser=function signOutUser(){return axiosClient.get('/user/signout');};var onModalClose=function onModalClose(){setShowModal(false);};var orderProduct=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(memo,amount,paymentMetadata){var paymentData,callbacks,payment;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(user===null)){_context2.next=2;break;}return _context2.abrupt(\"return\",setShowModal(true));case 2:paymentData={amount:amount,memo:memo,metadata:paymentMetadata};callbacks={onReadyForServerApproval:onReadyForServerApproval,onReadyForServerCompletion:onReadyForServerCompletion,onCancel:onCancel,onError:onError};_context2.next=6;return window.Pi.createPayment(paymentData,callbacks);case 6:payment=_context2.sent;console.log(payment);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function orderProduct(_x,_x2,_x3){return _ref2.apply(this,arguments);};}();var onIncompletePaymentFound=function onIncompletePaymentFound(payment){console.log(\"onIncompletePaymentFound\",payment);return axiosClient.post('/payments/incomplete',{payment:payment});};var onReadyForServerApproval=function onReadyForServerApproval(paymentId){console.log(\"onReadyForServerApproval\",paymentId);axiosClient.post('/payments/approve',{paymentId:paymentId},config);};var onReadyForServerCompletion=function onReadyForServerCompletion(paymentId,txid){console.log(\"onReadyForServerCompletion\",paymentId,txid);axiosClient.post('/payments/complete',{paymentId:paymentId,txid:txid},config);};var onCancel=function onCancel(paymentId){console.log(\"onCancel\",paymentId);return axiosClient.post('/payments/cancelled_payment',{paymentId:paymentId});};var onError=function onError(error,payment){console.log(\"onError\",error);if(payment){console.log(payment);// handle the error accordingly\n}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{user:user,onSignIn:signIn,onSignOut:signOut}),/*#__PURE__*/_jsx(ProductCard,{name:\"Abortion Rights\",description:\" The new abortion laws in the United States are a great example of why abortion stigma is a big issue that has to be tackled. This community supports and openly talks about abortion to empower each other and educate the rest of the world.\",price:1,pictureURL:\"https://static.vecteezy.com/system/resources/previews/009/730/589/non_2x/women-with-banners-my-body-my-choice-my-right-vector.jpg\",pictureCaption:\"https://static.vecteezy.com/system/resources/previews/009/730/589/non_2x/women-with-banners-my-body-my-choice-my-right-vector.jpg\",onClickBuy:function onClickBuy(){return orderProduct(\"Pay to enter community\",1,{productId:'Abortion Rights'});}}),/*#__PURE__*/_jsx(ProductCard,{name:\"Mental Health\",description:\"Talking opnely about mental health creates a culture of understanding. By starting conversations about mental health, we can create a more inclusive and compassionate society where people feel comfortable seeking help and support when they need it.\",price:1,pictureURL:\"https://www.planstreetinc.com/wp-content/uploads/2021/07/what-is-mental-health.png\",pictureCaption:\"ttps://www.planstreetinc.com/wp-content/uploads/2021/07/what-is-mental-health.png\",onClickBuy:function onClickBuy(){return orderProduct(\"Pay to enter community\",1,{productId:'Mental Health'});}}),/*#__PURE__*/_jsx(ProductCard,{name:\"Period Stigma\",description:\"Periods are beautiful and normal, they should be celebrated and not hidden. This community aims to normalize talking about periods to ensure that menstruators are healthy and comfortable in their bodies.  \",price:1,pictureURL:\"https://www.healthywomen.org/media-library/image.jpg?id=27287943&width=1200&height=800&quality=85&coordinates=0%2C169%2C0%2C0\",pictureCaption:\"https://www.healthywomen.org/media-library/image.jpg?id=27287943&width=1200&height=800&quality=85&coordinates=0%2C169%2C0%2C0\",onClickBuy:function onClickBuy(){return orderProduct(\"Pay to enter community\",1,{productId:'Period Stigma'});}}),showModal&&/*#__PURE__*/_jsx(SignIn,{onSignIn:signIn,onModalClose:onModalClose,onPosts:function onPosts(){throw new Error('Function not implemented.');}})]});}","map":null,"metadata":{},"sourceType":"module"}